/*! xtend v0.0.5 (http://)
@copyright (c) 2016 - 2017 Riccardo Caroli
@license MIT (https://github.com/minimit/xtend/blob/master/LICENSE) */
!function(t,e,s,a){"use strict";function i(e,s,a){this.element=e,this.settings=t.extend({},a,s),this._defaults=a,this.init()}function r(t,e,s){i.call(this,t,e,s)}function n(t,e,s){i.call(this,t,e,s)}function o(t,e,s){i.call(this,t,e,s)}function l(t,e,s){i.call(this,t,e,s)}t.fn.xt=function(e){var s={type:"xt",on:"click",target:"",class:"active",group:"",grouping:"xt",min:0,max:1};return this.each(function(){t.data(this,"xt_xt")||t.data(this,"xt_xt",new i(this,e,s))})},r.prototype=Object.create(i.prototype),t.fn.xtAjax=function(e){var s={type:"ajax",on:"click",target:"",class:"active",group:"",grouping:"xt",url:"href"};return this.each(function(){t.data(this,"xt_ajax")||t.data(this,"xt_ajax",new r(this,e,s))})},n.prototype=Object.create(i.prototype),t.fn.xtToggle=function(e){var s={type:"toggle",on:"click",target:"",class:"active",group:"",grouping:"xt",min:0,max:1};return this.each(function(){t.data(this,"xt_toggle")||t.data(this,"xt_toggle",new n(this,e,s))})},o.prototype=Object.create(i.prototype),t.fn.xtCollapse=function(e){var s={type:"collapse",on:"click",target:"",class:"active",group:"",grouping:"xt",min:1,max:1};return this.each(function(){t.data(this,"xt_collapse")||t.data(this,"xt_collapse",new o(this,e,s))})},l.prototype=Object.create(i.prototype),t.fn.xtScroll=function(e){var s={type:"scroll",on:"scroll",target:"",class:"active",group:"",grouping:"xt",min:0,max:1,$clone:null};return this.each(function(){t.data(this,"xt_scroll")||t.data(this,"xt_scroll",new l(this,e,s))})},t.fn.xtInit=function(){return this.each(function(){t(this).find("[data-xt]").xt(),t(this).find("[data-xt-ajax]").xtAjax(),t(this).find("[data-xt-toggle]").xtToggle(),t(this).find("[data-xt-collapse]").xtCollapse(),t(this).find("[data-xt-scroll]").xtScroll()})},t(s).ready(function(){t.fn.xt.manualInit||t("html").xtInit()}),i.prototype.init=function(){var s=this,a=this.settings,i=(this.element,t(this.element));(i.attr("debug")||""===i.attr("debug"))&&(a.debug=!0);var r=i.data("xt-"+a.type);"xt"===a.type&&(r=i.data("xt")),r&&t.extend(a,r),this.scoping(),this.events(),e.requestAnimFrame(function(){s.setup()})},i.prototype.scoping=function(){var e=this.settings,s=(this.element,t(this.element));e.target&&e.group?(e.$group=s.parents(e.group),e.$target=e.$group.find(e.target)):e.target?(e.$target=t(e.target),e.$group=e.$target.parent()):e.$group=s.parent(),e.namespace=e.grouping+"_"+e.group,s.attr("data-xt-button",e.namespace)},i.prototype.setup=function(){var a=this,i=this.settings,r=(this.element,t(this.element));"href"===i.url&&(i.url=r.attr("href"));var n=this.getButtons();if(n.each(function(e){t(this).is(r)&&(i.groupIndex=e)}),i.target&&i.$target.length>1&&(i.$target=i.$target.eq(i.groupIndex)),r.hasClass(i.class)&&this.show(),i.url){r.attr("data-xt-pushstate","true");var o;if(history.state&&history.state.url)i.url===history.state.url&&(o=!0);else{var l=e.location.href.split("#")[0];l=l.replace(/https?:\/\/[^\/]+/i,""),l===i.url&&(o=!0)}o&&(i.title=i.title?i.title:s.title,i.$target.attr("data-xt-ajaxified",i.url),this.pushstate(),this.show(),i.$target.trigger("ajax.init.xt",[a]))}else{var h=i.min,c=n.filter("."+i.class);c.length<h&&this.show()}},i.prototype.events=function(){var a=this,i=this.settings,r=(this.element,t(this.element));if("scroll"===i.type){i.$clone||(r.wrap(t('<div class="box xt-container"></div>')),i.$clone=r.clone().addClass("box xt-ignore").css("visibility","hidden").css("display","none"),t.each(i.$clone.data(),function(t){i.$clone.removeAttr("data-"+t)}),i.$clone.insertAfter(r));var n="scroll.xt."+i.namespace;t(e).off(n),t(e).on(n,function(){var e=t(this),s=e.scrollTop(),n=r.parents(".xt-container").offset().top,o=1/0;i.scrollTop&&(n=t(i.scrollTop).offset().top),i.scrollBottom&&(o=t(i.scrollBottom).offset().top),s>n&&s<o?(a.show(),i.$clone.css("display","block")):(a.hide(),i.$clone.css("display","none"))}),t(e).trigger(n)}else r.on(i.on,function(t){a.toggle(),i.url&&t.preventDefault()}),r.on(i.off,function(t){a.toggle()}),r.is("[data-xt-resetonajax]")&&t(s).on("ajax.success.xt",function(t,e,s){a.hide(!0,!1,!0)})},i.prototype.getButtons=function(){var e=this.settings,s=(this.element,t(this.element),e.$group.find('[data-xt-button="'+e.namespace+'"]').filter(":parents(.xt-ignore)"));return s},i.prototype.getCurrents=function(){var e=this.settings,s=(this.element,t(this.element),e.$group.data("$currents_"+e.namespace)||t([]));return s},i.prototype.setCurrents=function(e){var s=this.settings;this.element,t(this.element);return s.$group.data("$currents_"+s.namespace,e),e},i.prototype.toggle=function(e,s,a){var i=this,r=this.settings,n=(this.element,t(this.element)),o=this.getButtons();n.hasClass(r.class)?r.url||(this.hide(e,s,a),o.each(function(s){var i=t(this).data("xt_"+r.type);i.settings.$target&&i.settings.$target.is(r.$target)&&i.hide(e,!0,a)})):(this.show(e,s,a),r.url||o.each(function(s){var i=t(this).data("xt_"+r.type);i.settings.$target&&i.settings.$target.is(r.$target)&&i.show(e,!0,a)})),e||(n.trigger("toggle.xt",[i]),r.target&&r.$target.trigger("toggle.xt",[i]))},i.prototype.show=function(e,s,a){var i=this,r=this.settings,n=(this.element,t(this.element));if(!n.hasClass(r.class)){var o,l=this.getCurrents();if(n.addClass(r.class),l=this.setCurrents(l.pushElement(n)),r.target&&!r.$target.hasClass(r.class)&&(o=!0,r.$target.addClass(r.class)),r.url)this.checkDisabled("disable"),i.ajax(e,s,a);else if(this.checkDisabled(),!s&&l.length>r.max){var h=l.first().data("xt_"+r.type);h&&h.hide()}e||(n.trigger("show.xt",[i]),o&&r.$target.trigger("show.xt",[i]))}},i.prototype.hide=function(e,s,a){var i=this,r=this.settings,n=this.element,o=t(this.element);if(o.hasClass(r.class)){var l,h=this.getCurrents();(s||r.url||h.length>r.min)&&(o.removeClass(r.class),h=this.setCurrents(h.not(n)),r.target&&r.$target.hasClass(r.class)&&(l=!0,r.$target.removeClass(r.class))),s||r.url?this.checkDisabled("enable"):this.checkDisabled(),e||(o.trigger("hide.xt",[i]),l&&r.$target.trigger("hide.xt",[i]))}},i.prototype.checkDisabled=function(e){var s=this.settings,a=(this.element,t(this.element)),i=this.getCurrents();if(e)"disable"===e?a.attr("disabled",""):"enable"===e&&a.removeAttr("disabled");else{var r=s.min;i.length===r?i.attr("disabled",""):i.removeAttr("disabled")}},i.prototype.ajax=function(e,s,a){var i=this,r=this.settings;this.element,t(this.element);r.$target.attr("data-xt-ajaxified")!==r.url&&t.ajax({type:"GET",url:r.url,success:function(e,s,n){var o=t("<div />").html(e);r.$target.trigger("ajax.success.xt",[i,o]);var l=o.find(r.target).contents();r.$target.html(l),r.$target.attr("data-xt-ajaxified",r.url),a||(r.title=r.title?r.title:o.find("title").text(),i.pushstate(!0)),r.$target.trigger("ajax.done.xt",[i,o])},error:function(t,e,s){console.error("ajax error url:"+r.url+" "+s)}})},i.prototype.pushstate=function(e){var a=this.settings,i=(this.element,t(this.element),a.title);if(!history.state||!history.state.url||history.state.url!==a.url){var r=a.url;history.pushState({url:r,title:i},i,r),t(s).find("[data-xt-pushstate]").filter(":parents(.xt-ignore)").each(function(s){var i=t(this).data("xt_"+a.type);i.pushstateListener(r,e)})}s.title=i},i.prototype.pushstateListener=function(e,s){var a=this,i=this.settings;this.element,t(this.element);i.url===e?a.show(s,!1,!0):a.hide(s,!1,!0)},e.onpopstate=function(e){e.state&&e.state.url&&(s.title=e.state.title,t(s).find("[data-xt-pushstate]").filter(":parents(.xt-ignore)").each(function(s,a){var i=t(this).data("xt_ajax");i.pushstateListener(e.state.url)}))},e.requestAnimFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)}}(),t.fn.pushElement=function(t){return Array.prototype.push.apply(this,t),this},t.expr[":"].parents=function(e,s,a){return t(e).parents(a[3]).length<1}}(jQuery,window,document);