/*! xtend v0.0.5 (http://)
@copyright (c) 2016 - 2017 Riccardo Caroli
@license MIT (https://github.com/minimit/xtend/blob/master/LICENSE) */
!function(t,e,s,i){"use strict";var a=function(e,s,i){this.element=e,this.settings=t.extend({},i,s),this.init()};t.fn.xt=function(e){var s={name:"xt",type:"plugin_xt",on:"click",target:"",class:"active",group:"",grouping:"xt",min:0,max:1};return this.each(function(){t.data(this,"plugin_xt")||t.data(this,"plugin_xt",new a(this,e,s))})};var n=function(t,e,s){a.call(this,t,e,s)};n.prototype=Object.create(a.prototype),n.prototype.constructor=n,t.fn.xtAjax=function(e){var s={name:"xt-ajax",type:"plugin_xtAjax",on:"click",target:"",class:"active",group:"",grouping:"xt",url:"href"};return this.each(function(){t.data(this,"plugin_xtAjax")||t.data(this,"plugin_xtAjax",new n(this,e,s))})};var r=function(t,e,s){a.call(this,t,e,s)};r.prototype=Object.create(a.prototype),r.prototype.constructor=r,t.fn.xtToggle=function(e){var s={name:"xt-toggle",type:"plugin_xtToggle",on:"click",target:"",class:"active",group:"",grouping:"xt",min:0,max:1};return this.each(function(){t.data(this,"plugin_xtToggle")||t.data(this,"plugin_xtToggle",new r(this,e,s))})};var o=function(t,e,s){a.call(this,t,e,s)};o.prototype=Object.create(a.prototype),o.prototype.constructor=o,t.fn.xtCollapse=function(e){var s={name:"xt-collapse",type:"plugin_xtCollapse",on:"click",target:"",class:"active",group:"",grouping:"xt",min:1,max:1};return this.each(function(){t.data(this,"plugin_xtCollapse")||t.data(this,"plugin_xtCollapse",new o(this,e,s))})};var l=function(t,e,s){a.call(this,t,e,s)};l.prototype=Object.create(a.prototype),l.prototype.constructor=l,t.fn.xtMenu=function(e){var s={name:"xt-menu",type:"plugin_xtMenu",on:"click",target:"html",class:"menu",group:"",grouping:"xt",min:0,max:1};return this.each(function(){t.data(this,"plugin_xtMenu")||t.data(this,"plugin_xtMenu",new l(this,e,s))})};var h=function(t,e,s){a.call(this,t,e,s)};h.prototype=Object.create(a.prototype),h.prototype.constructor=h,t.fn.xtScroll=function(e){var s={name:"xt-scroll",type:"plugin_xtScroll",on:"scroll",target:"html",class:"scroll",group:"",grouping:"xt",min:0,max:1,$clone:null};return this.each(function(){t.data(this,"plugin_xtScroll")||t.data(this,"plugin_xtScroll",new h(this,e,s))})},t.fn.xtInitAll=function(){return this.each(function(){t(this).is("[data-xt]")&&t(this).xt(),t(this).is("[data-xt-ajax]")&&t(this).xtAjax(),t(this).is("[data-xt-toggle]")&&t(this).xtToggle(),t(this).is("[data-xt-collapse]")&&t(this).xtCollapse(),t(this).is("[data-xt-menu]")&&t(this).xtMenu(),t(this).is("[data-xt-scroll]")&&t(this).xtScroll(),t(this).find("[data-xt]").xt(),t(this).find("[data-xt-ajax]").xtAjax(),t(this).find("[data-xt-toggle]").xtToggle(),t(this).find("[data-xt-collapse]").xtCollapse(),t(this).find("[data-xt-menu]").xtMenu(),t(this).find("[data-xt-scroll]").xtScroll()})},t(s).ready(function(){t.fn.xtInitManual||t("html").xtInitAll()}),a.prototype.init=function(){var s=this,i=this.settings,a=(this.element,t(this.element));(a.attr("debug")||""===a.attr("debug"))&&(i.debug=!0),t.extend(i,a.data(i.name)),this.scoping(),this.events(),e.requestAnimFrame(function(){s.setup()})},a.prototype.scoping=function(){var e=this.settings,s=(this.element,t(this.element));e.target&&e.group?(e.$group=s.parents(e.group),e.$target=e.$group.find(e.target)):e.target?(e.$target=t(e.target),e.$group=e.$target.parent()):e.$group=s.parent(),e.namespace=e.grouping+"_"+e.group,s.attr("data-xt-button",e.namespace)},a.prototype.setup=function(){var i=this,a=this.settings,n=(this.element,t(this.element));"href"===a.url&&(a.url=n.attr("href"));var r=this.getButtons();if(r.each(function(e){t(this).is(n)&&(a.groupIndex=e)}),a.target&&a.$target.length>1&&(a.$target=a.$target.eq(a.groupIndex)),n.hasClass(a.class)&&this.show(),a.url){n.attr("data-xt-pushstate","true");var o;if(history.state&&history.state.url)a.url===history.state.url&&(o=!0);else{var l=e.location.href.split("#")[0];l=l.replace(/https?:\/\/[^\/]+/i,""),l===a.url&&(o=!0)}o&&(a.title=a.title?a.title:s.title,a.$target.attr("data-xt-ajaxified",a.url),this.pushstate(),this.show(),a.$target.trigger("ajax.init.xt",[i]))}else{var h=a.min,u=r.filter("."+a.class);u.length<h&&this.show()}},a.prototype.events=function(){var i=this,a=this.settings,n=(this.element,t(this.element));if("xt-scroll"===a.name){a.$clone||(n.wrap(t('<div class="box xt-container"></div>')),a.$clone=n.clone().addClass("box xt-ignore").css("visibility","hidden").css("display","none"),t.each(a.$clone.data(),function(t){a.$clone.removeAttr("data-"+t)}),a.$clone.insertAfter(n));var r="scroll.xt."+a.namespace;t(e).off(r),t(e).on(r,function(e){var s=t(this),r=s.scrollTop(),o=n.parents(".xt-container").offset().top,l=1/0;a.scrollTop&&(o=t(a.scrollTop).offset().top),a.scrollBottom&&(l=t(a.scrollBottom).offset().top),r>o&&r<l?(i.show(),a.$clone.css("display","block")):(i.hide(),a.$clone.css("display","none"))}),t(e).trigger(r),n.off("xtRemoved"),n.on("xtRemoved",function(s){t(e).off(r)})}else n.on(a.on,function(t){i.toggle(),a.url&&t.preventDefault()}),n.on(a.off,function(t){i.toggle()}),n.is("[data-xt-resetonajax]")&&t(s).on("ajax.success.xt",function(t,e,s){i.hide(!0,!1,!0)})},a.prototype.getButtons=function(){var e=this.settings,s=(this.element,t(this.element),e.$group.find('[data-xt-button="'+e.namespace+'"]').filter(":parents(.xt-ignore)"));return s},a.prototype.getCurrents=function(){var e=this.settings,s=(this.element,t(this.element),e.$group.data("$currents_"+e.namespace)||t([]));return s},a.prototype.setCurrents=function(e){var s=this.settings;this.element,t(this.element);return s.$group.data("$currents_"+s.namespace,e),e},a.prototype.toggle=function(e,s,i){var a=this,n=this.settings,r=(this.element,t(this.element)),o=this.getButtons();r.hasClass(n.class)?n.url||(this.hide(e,s,i),o.each(function(s){var a=t(this).data(n.type);a.settings.$target&&a.settings.$target.is(n.$target)&&a.hide(e,!0,i)})):(this.show(e,s,i),n.url||o.each(function(s){var a=t(this).data(n.type);a.settings.$target&&a.settings.$target.is(n.$target)&&a.show(e,!0,i)})),e||(r.trigger("toggle.xt",[a]),n.target&&n.$target.trigger("toggle.xt",[a]))},a.prototype.show=function(e,s,i){var a=this,n=this.settings,r=(this.element,t(this.element));if(!r.hasClass(n.class)){var o,l=this.getCurrents();if(r.addClass(n.class),l=this.setCurrents(l.pushElement(r)),n.target&&!n.$target.hasClass(n.class)&&(o=!0,n.$target.addClass(n.class)),n.url)this.checkDisabled("disable"),a.ajax(e,s,i);else if(this.checkDisabled(),!s&&l.length>n.max){var h=l.first().data(n.type);h&&h.hide()}e||(r.trigger("show.xt",[a]),o&&n.$target.trigger("show.xt",[a]))}},a.prototype.hide=function(e,s,i){var a=this,n=this.settings,r=this.element,o=t(this.element);if(o.hasClass(n.class)){var l,h=this.getCurrents();(s||n.url||h.length>n.min)&&(o.removeClass(n.class),h=this.setCurrents(h.not(r)),n.target&&n.$target.hasClass(n.class)&&(l=!0,n.$target.removeClass(n.class))),s||n.url?this.checkDisabled("enable"):this.checkDisabled(),e||(o.trigger("hide.xt",[a]),l&&n.$target.trigger("hide.xt",[a]))}},a.prototype.checkDisabled=function(e){var s=this.settings,i=(this.element,t(this.element)),a=this.getCurrents();if(e)"disable"===e?i.attr("disabled",""):"enable"===e&&i.removeAttr("disabled");else{var n=s.min;a.length===n?a.attr("disabled",""):a.removeAttr("disabled")}},a.prototype.ajax=function(e,s,i){var a=this,n=this.settings;this.element,t(this.element);n.$target.attr("data-xt-ajaxified")!==n.url&&t.ajax({type:"GET",url:n.url,success:function(e,s,r){var o=t("<div />").html(e);n.$target.trigger("ajax.success.xt",[a,o]);var l=o.find(n.target).contents();n.$target.html(l),n.$target.attr("data-xt-ajaxified",n.url),i||(n.title=n.title?n.title:o.find("title").text(),a.pushstate(!0)),n.$target.trigger("ajax.done.xt",[a,o])},error:function(t,e,s){console.error("ajax error url:"+n.url+" "+s)}})},a.prototype.pushstate=function(e){var i=this.settings,a=(this.element,t(this.element),i.title);if(!history.state||!history.state.url||history.state.url!==i.url){var n=i.url;history.pushState({url:n,title:a},a,n),t(s).find("[data-xt-pushstate]").filter(":parents(.xt-ignore)").each(function(s){var a=t(this).data(i.type);a.pushstateListener(n,e)})}s.title=a},a.prototype.pushstateListener=function(e,s){var i=this,a=this.settings;this.element,t(this.element);a.url===e?i.show(s,!1,!0):i.hide(s,!1,!0)},e.onpopstate=function(e){e.state&&e.state.url&&(s.title=e.state.title,t(s).find("[data-xt-pushstate]").filter(":parents(.xt-ignore)").each(function(s,i){var a=t(this).data("plugin_xtAjax");a.pushstateListener(e.state.url)}))},e.requestAnimFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)}}(),t.fn.pushElement=function(t){return Array.prototype.push.apply(this,t),this},t.event.special.xtRemoved={remove:function(t){t.handler&&t.handler()}},t.expr[":"].parents=function(e,s,i){return t(e).parents(i[3]).length<1}}(jQuery,window,document);