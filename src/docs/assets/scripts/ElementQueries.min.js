/**
 * Copyright Marc J. Schmidt. See the LICENSE file at the top-level
 * directory of this distribution and at
 * https://github.com/marcj/css-element-queries/blob/master/LICENSE.
 */
;!function(a,b){"function"==typeof define&&define.amd?define(["./ResizeSensor.js"],b):"object"==typeof exports?module.exports=b(require("./ResizeSensor.js")):a.ElementQueries=b(a.ResizeSensor)}(this,function(a){var b=function(){function e(a){a||(a=document.documentElement);var b=window.getComputedStyle(a,null).fontSize;return parseFloat(b)||16}function f(a,b){var c=b.split(/\d/),d=c[c.length-1];switch(b=parseFloat(b),d){case"px":return b;case"em":return b*e(a);case"rem":return b*e();case"vw":return b*document.documentElement.clientWidth/100;case"vh":return b*document.documentElement.clientHeight/100;case"vmin":case"vmax":var f=document.documentElement.clientWidth/100,g=document.documentElement.clientHeight/100,h=Math["vmin"===d?"min":"max"];return b*h(f,g);default:return b}}function g(a){this.element=a,this.options={};var b,c,g,h,i,j,k,d=0,e=0;this.addOption=function(a){var b=[a.mode,a.property,a.value].join(",");this.options[b]=a};var l=["min-width","min-height","max-width","max-height"];this.call=function(){d=this.element.offsetWidth,e=this.element.offsetHeight,i={};for(b in this.options)this.options.hasOwnProperty(b)&&(c=this.options[b],g=f(this.element,c.value),h="width"==c.property?d:e,k=c.mode+"-"+c.property,j="","min"==c.mode&&h>=g&&(j+=c.value),"max"==c.mode&&h<=g&&(j+=c.value),i[k]||(i[k]=""),j&&-1===(" "+i[k]+" ").indexOf(" "+j+" ")&&(i[k]+=" "+j));for(var a in l)l.hasOwnProperty(a)&&(i[l[a]]?this.element.setAttribute(l[a],i[l[a]].substr(1)):this.element.removeAttribute(l[a]))}}function h(b,e){b.elementQueriesSetupInformation?b.elementQueriesSetupInformation.addOption(e):(b.elementQueriesSetupInformation=new g(b),b.elementQueriesSetupInformation.addOption(e),b.elementQueriesSensor=new a(b,function(){b.elementQueriesSetupInformation.call()})),b.elementQueriesSetupInformation.call(),c&&d.indexOf(b)<0&&d.push(b)}function j(a,b,c,d){"undefined"==typeof i[b]&&(i[b]={}),"undefined"==typeof i[b][c]&&(i[b][c]={}),"undefined"==typeof i[b][c][d]?i[b][c][d]=a:i[b][c][d]+=","+a}function k(){var a;if(document.querySelectorAll&&(a=document.querySelectorAll.bind(document)),a||"undefined"==typeof $$||(a=$$),a||"undefined"==typeof jQuery||(a=jQuery),!a)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return a}function l(){var a=k();for(var b in i)if(i.hasOwnProperty(b))for(var c in i[b])if(i[b].hasOwnProperty(c))for(var d in i[b][c])if(i[b][c].hasOwnProperty(d))for(var e=a(i[b][c][d]),f=0,g=e.length;f<g;f++)h(e[f],{mode:b,property:c,value:d})}function m(b){function o(){var c,a=!1;for(c in e)e.hasOwnProperty(c)&&f[c].minWidth&&b.offsetWidth>f[c].minWidth&&(a=c);if(a||(a=h),i!=a)if(j[a])e[i].style.display="none",e[a].style.display="block",i=a;else{var d=new Image;d.onload=function(){e[a].src=g[a],e[i].style.display="none",e[a].style.display="block",j[a]=!0,i=a},d.src=g[a]}else e[a].src=g[a]}var e=[],f=[],g=[],h=0,i=-1,j=[];for(var k in b.children)if(b.children.hasOwnProperty(k)&&b.children[k].tagName&&"img"===b.children[k].tagName.toLowerCase()){e.push(b.children[k]);var l=b.children[k].getAttribute("min-width")||b.children[k].getAttribute("data-min-width"),m=b.children[k].getAttribute("data-src")||b.children[k].getAttribute("url");g.push(m);var n={minWidth:l};f.push(n),l?b.children[k].style.display="none":(h=e.length-1,b.children[k].style.display="block")}i=h,b.resizeSensor=new a(b,o),o(),c&&d.push(b)}function n(){for(var a=k(),b=a("[data-responsive-image],[responsive-image]"),c=0,d=b.length;c<d;c++)m(b[c])}function q(a){var b,c;for(a=a.replace(/'/g,'"');null!==(b=o.exec(a));)for(c=b[1]+b[3],attrs=b[2];null!==(attrMatch=p.exec(attrs));)j(c,attrMatch[1],attrMatch[2],attrMatch[3])}function r(a){var b="";if(a)if("string"==typeof a)a=a.toLowerCase(),-1===a.indexOf("min-width")&&-1===a.indexOf("max-width")||q(a);else for(var c=0,d=a.length;c<d;c++)1===a[c].type?(b=a[c].selectorText||a[c].cssText,-1!==b.indexOf("min-height")||-1!==b.indexOf("max-height")?q(b):-1===b.indexOf("min-width")&&-1===b.indexOf("max-width")||q(b)):4===a[c].type&&r(a[c].cssRules||a[c].rules)}var c=!1,d=[],i={},o=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,p=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim,s=!1;this.init=function(a){c="undefined"!=typeof a&&a;for(var b=0,d=document.styleSheets.length;b<d;b++)try{r(document.styleSheets[b].cssRules||document.styleSheets[b].rules||document.styleSheets[b].cssText)}catch(a){if("SecurityError"!==a.name)throw a}if(!s){var e=document.createElement("style");e.type="text/css",e.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img { width: 100%;}",document.getElementsByTagName("head")[0].appendChild(e),s=!0}l(),n()},this.update=function(a){this.init(a)},this.detach=function(){if(!this.withTracking)throw"withTracking is not enabled. We can not detach elements since we don not store it.Use ElementQueries.withTracking = true; before domready or call ElementQueryes.update(true).";for(var a;a=d.pop();)b.detach(a);d=[]}};b.update=function(a){b.instance.update(a)},b.detach=function(a){a.elementQueriesSetupInformation?(a.elementQueriesSensor.detach(),delete a.elementQueriesSetupInformation,delete a.elementQueriesSensor):a.resizeSensor&&(a.resizeSensor.detach(),delete a.resizeSensor)},b.withTracking=!1,b.init=function(){b.instance||(b.instance=new b),b.instance.init(b.withTracking)};var c=function(a){if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var b=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(a(),clearInterval(b))},10);else window.onload=a};return b.listen=function(){c(b.init)},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=b:(window.ElementQueries=b,b.listen()),b});