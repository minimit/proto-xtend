/*! xtend v0.0.3 (http://)
@copyright (c) 2016 - 2017 Riccardo Caroli
@license MIT (https://github.com/minimit/xtend/blob/master/LICENSE) */
!function(t,e,a,s){"use strict";function i(e,a){this.element=e,this.settings=t.extend({},r,a),this._defaults=r,this._name=n,this.init()}var n="xtend",r={on:"click",target:"",toggle:"active",htmlClass:"",group:"",grouping:"xtend",min:1,max:1,ajax:null,url:null,groupIndex:null};t.extend(i.prototype,{init:function(){var a=this,s=this.settings,i=(this.element,t(this.element)),n=i.data("xtend");t.extend(s,n),i.attr("data-xtend")||i.attr("data-xtend",""),(i.attr("debug")||""===i.attr("debug"))&&(s.debug=!0),a.scoping(),a.events(),e.requestAnimFrame(function(){a.setup()})},scoping:function(){var e=this.settings,a=(this.element,t(this.element));e.target&&e.group?(e.$group=a.parents(e.group),e.$target=e.$group.find(e.target)):e.target?(e.$target=t(e.target),e.$group=e.$target.parent()):e.$group=a.parent(),e.namespace=e.grouping+"_"+e.group,a.attr("data-xtend-namespace",e.namespace)},setup:function(){var s=this,i=this.settings,n=(this.element,t(this.element));i.ajax&&"href"===i.ajax.url&&(i.ajax.url=n.attr("href"));var r=this.getButtons();if(r.each(function(e){t(this).is(n)&&(i.groupIndex=e)}),i.$target&&i.$target.length>1&&(i.$target=i.$target.eq(i.groupIndex)),n.hasClass(i.toggle)&&this.show(),i.ajax){n.attr("data-xtend-pushstate","true");var h;if(history.state&&history.state.url)i.ajax.url===history.state.url&&(h=!0);else{var l=e.location.href.split("#")[0];l.match(i.ajax.url+"$")&&(h=!0)}if(h){var g=i.ajax.title||a.title;i.$target.attr("data-xtend-ajaxified",i.ajax.url),this.pushstate(g),this.show(),i.$target.trigger("xtend.ajax.init",[s])}}else{var u=i.min,o=r.filter("."+i.toggle);o.length<u&&this.show()}},events:function(){var e=this,a=this.settings,s=(this.element,t(this.element));s.on(a.on,function(t){e.toggle(),a.ajax&&t.preventDefault()})},getButtons:function(){var e=this.settings,a=(this.element,t(this.element),e.$group.find('[data-xtend-namespace="'+e.namespace+'"]'));return a},getCurrents:function(){var e=this.settings,a=(this.element,t(this.element),e.$group.data("$currents_"+e.namespace)||t([]));return a},setCurrents:function(e){var a=this.settings;this.element,t(this.element);return a.$group.data("$currents_"+a.namespace,e),e},toggle:function(e,a){var s=this,i=this.settings,n=(this.element,t(this.element));n.hasClass(i.toggle)?i.ajax||this.hide(e,a):this.show(e,a),e||(n.trigger("xtend.toggle",[s]),i.target&&i.$target.trigger("xtend.toggle",[s]))},show:function(e,a){var s=this,i=this.settings,n=(this.element,t(this.element));if(!n.hasClass(i.toggle)){var r=this.getCurrents();if(n.addClass(i.toggle),r=this.setCurrents(r.pushElement(n)),i.$target&&i.$target.addClass(i.toggle),i.htmlClass&&t("html").addClass(i.htmlClass),i.ajax)this.checkDisabled("disable"),s.ajax(a);else{this.checkDisabled();var h=i.max;if(r.length>h){var l=r.first().data("plugin_xtend");l&&l.hide()}}e||(n.trigger("xtend.show",[s]),i.target&&i.$target.trigger("xtend.show",[s]))}},hide:function(e,a){var s=this,i=this.settings,n=this.element,r=t(this.element);if(r.hasClass(i.toggle)){var h=this.getCurrents(),l=i.min;(h.length>l||i.ajax)&&(r.removeClass(i.toggle),h=this.setCurrents(h.not(n)),i.$target&&i.$target.removeClass(i.toggle),i.htmlClass&&t("html").removeClass(i.htmlClass)),i.ajax?this.checkDisabled("enable"):this.checkDisabled(),e||(r.trigger("xtend.hide",[s]),i.target&&i.$target.trigger("xtend.hide",[s]))}},checkDisabled:function(e){var a=this.settings,s=(this.element,t(this.element)),i=this.getCurrents();if(e)"disable"===e?s.attr("disabled",""):"enable"===e&&s.removeAttr("disabled");else{var n=a.min;i.length===n?i.attr("disabled",""):i.removeAttr("disabled")}},ajax:function(e){var a=this,s=this.settings;this.element,t(this.element);s.$target.attr("data-xtend-ajaxified")!==s.ajax.url&&t.ajax({type:"GET",url:s.ajax.url,success:function(i,n,r){var h=t("<div />").html(i);s.$target.attr("data-xtend-ajaxified",s.ajax.url);var l=h.find(s.target);if(s.$target.html(l),!e){var g=s.ajax.title||h.find("title").text();a.pushstate(g,!0)}s.$target.trigger("xtend.ajax.done",[a,h])},error:function(t,e,a){console.error("ajax error url:"+s.ajax.url+" "+a)}})},pushstate:function(e,s){var i=this.settings;this.element,t(this.element);if(!history.state||!history.state.url||history.state.url!==i.ajax.url){var n=i.ajax.url;history.pushState({url:n,title:e},e,n),t(a).find("[data-xtend-pushstate]").each(function(e){var a=t(this).data("plugin_xtend");a.pushstateListener(n,s)})}a.title=e},pushstateListener:function(e,a){var s=this,i=this.settings;this.element,t(this.element);i.ajax.url===e?s.show(a,!0):s.hide(a,!0)}}),t.fn[n]=function(e){return this.each(function(){t.data(this,"plugin_"+n)||t.data(this,"plugin_"+n,new i(this,e))})},e.onpopstate=function(e){e.state&&e.state.url&&(a.title=e.state.title,t(a).find("[data-xtend-pushstate]").each(function(a,s){var i=t(this).data("plugin_xtend");i.pushstateListener(e.state.url,!1)}))},e.requestAnimFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)}}(),t.fn.pushElement=function(t){return Array.prototype.push.apply(this,t),this},t.fn[n].manualInit||t("[data-"+[n]+"]")[n]()}(jQuery,window,document);