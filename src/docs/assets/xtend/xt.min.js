/*! xtend v0.0.6 (http://www.minimit.com/xtend/)
@copyright (c) 2016 - 2017 Riccardo Caroli
@license MIT (https://github.com/minimit/xtend/blob/master/LICENSE) */
!function(t,e,s,i){"use strict";var a=function(e,s,i){this.group=e,this.settings=t.extend({},i,s),this.init()},o=function(t,e,s){a.call(this,t,e,s)};o.prototype=Object.create(a.prototype),o.prototype.constructor=o,t.fn.xtToggle=function(e){var s={name:"xt-toggle",elements:null,targets:null,multiple:!1,class:"active",on:"click",off:null,min:0,max:1};return this.each(function(){t.data(this,s.name)||t.data(this,s.name,new o(this,e,s))})};var n=function(t,e,s){a.call(this,t,e,s)};n.prototype=Object.create(a.prototype),n.prototype.constructor=n,t.fn.xtOverlay=function(e){var s={name:"xt-overlay",targets:"html",multiple:!0,on:"click",class:"overlay",min:0,max:1};return this.each(function(){t.data(this,s.name)||t.data(this,s.name,new n(this,e,s))})};var r=function(t,e,s){a.call(this,t,e,s)};r.prototype=Object.create(a.prototype),r.prototype.constructor=r,t.fn.xtScroll=function(e){var s={name:"xt-scroll",on:"scroll",class:"scroll",min:0,max:1};return this.each(function(){t.data(this,s.name)||t.data(this,s.name,new r(this,e,s))})};var h=function(t,e,s){a.call(this,t,e,s)};h.prototype=Object.create(a.prototype),h.prototype.constructor=h,t.fn.xtAjax=function(e){var s={name:"xt-ajax",targets:null,on:"click",class:"active",url:null};return this.each(function(){t.data(this,s.name)||t.data(this,s.name,new h(this,e,s))})},t.fn.xtInitAll=function(e){return this.each(function(){t(this).is("[data-xt-toggle]")&&t(this).xtToggle(),t(this).is("[data-xt-overlay]")&&t(this).xtOverlay(),t(this).is("[data-xt-scroll]")&&t(this).xtScroll(),t(this).is("[data-xt-ajax]")&&t(this).xtAjax(),e&&(t(this).find("[data-xt-toggle]").xtToggle(),t(this).find("[data-xt-overlay]").xtOverlay(),t(this).find("[data-xt-scroll]").xtScroll(),t(this).find("[data-xt-ajax]").xtAjax())})},a.prototype.init=function(){var e=this.settings,s=(this.group,t(this.group));(s.attr("debug")||""===s.attr("debug"))&&(e.debug=!0),t.extend(e,s.data(e.name)),this.scoping(),this.setup(),this.events()},a.prototype.scoping=function(){var s=this.settings,i=(this.group,t(this.group));s.elements?(s.$elements=i.find(s.elements).filter(":parents(.xt-ignore)"),s.$elements.length||(s.$elements=t(s.elements).filter(":parents(.xt-ignore)"))):s.$elements=i,"xt-scroll"===s.name?(i.wrap(t('<div class="xt-container"></div>')),s.$targets=i.clone().addClass("xt-clone xt-ignore").css("visibility","hidden"),t.each(s.$targets.data(),function(t){s.$targets.removeAttr("data-"+t)}),s.$targets.insertAfter(i),"absolute"===s.mode?i.css("position","absolute"):"fixed"===s.mode&&i.css("position","fixed"),i.is(":fixed")||i.is(":absolute")?(i.css("z-index",70),s.$targets.css("display","block")):s.$targets.css("display","none")):s.targets&&(s.$targets=i.find(s.targets).filter(":parents(.xt-ignore)"),s.$targets.length||(s.$targets=t(s.targets).filter(":parents(.xt-ignore)"))),e.xtUniqueId=e.xtUniqueId?e.xtUniqueId:0;var a=i.attr("id")?i.attr("id"):"xtUniqueId"+e.xtUniqueId++;i.attr("id",a),s.namespace=s.name+"_"+a+"_"+s.class,i.attr("data-xt-group-"+s.name,s.namespace)},a.prototype.setup=function(){var i=this,a=this.settings;this.group,t(this.group);if("xt-ajax"===a.name){var o,n;if(history.state&&history.state.url)o=history.state.url;else{var r=e.location.href.split("#")[0];o=r.replace(/https?:\/\/[^\/]+/i,"")}a.$elements.each(function(){if(t(this).attr("href")===o)return n=t(this),!1}),n&&(a.$targets.attr("data-xt-ajaxified",o),this.pushstate(o,s.title),this.show(n),a.$targets.trigger("ajax.init.xt",[i]))}else if(a.$elements){a.$elements.each(function(){t(this).hasClass(a.class)&&(t(this).removeClass(a.class),i.show(t(this)))});var h=a.min,l=this.getCurrents();l.length<h&&i.show(a.$elements.eq(0))}},a.prototype.events=function(){var e=this.settings;this.group,t(this.group);"xt-scroll"===e.name?this.eventsScroll():this.eventsDefault()},a.prototype.eventsDefault=function(){var s=this,i=this.settings;this.group,t(this.group);i.$elements&&(i.on&&i.$elements.on(i.on,function(e){s.toggle(t(this)),"xt-ajax"===i.name&&e.preventDefault()}),i.off&&i.$elements.on(i.off,function(e){s.toggle(t(this))}),i.$elements.on("xtRemoved",function(e){(t(this).is("[data-xt-reset]")||"html"===i.targets)&&s.hide(t(this),!1,!0,!0)}),i.$elements.on("show.xt",function(e,i,a){a||e.target!==this||s.show(t(this),!0)}),i.$elements.on("hide.xt",function(e,i,a){a||e.target!==this||s.hide(t(this),!0)})),"xt-ajax"===i.name&&(t(e).off("popstate.xt."+i.namespace),t(e).on("popstate.xt."+i.namespace,function(t){history.state&&history.state.url&&s.ajax(history.state.url,history.state.title)}))},a.prototype.eventsScroll=function(){var s=this,i=this.settings,a=(this.group,t(this.group)),o="scroll.xt."+i.namespace;t(e).off(o),t(e).on(o,function(o){var n=t(this).scrollTop(),r=i.$targets.parents(".xt-container").offset().top,h=1/0;i.top&&(r=isNaN(parseFloat(i.top))?t(i.top).offset().top:i.top),i.bottom&&(h=isNaN(parseFloat(i.bottom))?t(i.bottom).offset().top:i.bottom),n>r&&n<h?a.hasClass(i.class)||(s.show(a),a.removeClass("scroll-off-top scroll-off-bottom"),i.scrollTopOld>n?(a.removeClass("scroll-on-top"),e.xtRequestAnimationFrame(function(){a.addClass("scroll-on-bottom")})):(a.removeClass("scroll-on-bottom"),e.xtRequestAnimationFrame(function(){a.addClass("scroll-on-top")}))):a.hasClass(i.class)&&(s.hide(a),a.removeClass("scroll-on-top scroll-on-bottom"),i.scrollTopOld>n?(a.removeClass("scroll-off-top"),e.xtRequestAnimationFrame(function(){a.addClass("scroll-off-bottom")})):(a.removeClass("scroll-off-bottom"),e.xtRequestAnimationFrame(function(){a.addClass("scroll-off-top")}))),i.scrollTopOld=n}),t(e).trigger(o),a.on("xtRemoved",function(s){t(e).off(o)})},a.prototype.getCurrents=function(){var e=this.settings,s=(this.group,t(this.group)),i=s.data("$currents_"+e.namespace)||t([]);return i},a.prototype.setCurrents=function(e){var s=this.settings,i=(this.group,t(this.group));return i.data("$currents_"+s.namespace,e),e},a.prototype.toggle=function(e,s,i,a){var o=this,n=this.settings;this.group,t(this.group);e.hasClass(n.class)?n.multiple?n.$elements.each(function(e){o.hide(t(this),s,!0,a)}):this.hide(e,s,i,a):n.multiple?n.$elements.each(function(e){o.show(t(this),s,!0,a)}):this.show(e,s,i,a)},a.prototype.show=function(e,s,i,a){var o,n=this,r=this.settings,h=(this.group,t(this.group));if(e&&!e.hasClass(r.class)){o=!0,this.on(e);var l=this.getCurrents();l=this.setCurrents(l.xtPushElement(e)),"xt-ajax"===r.name?(this.checkDisabled(e,"disable"),n.ajax(e.attr("href"))):(this.checkDisabled(e),i||l.length>r.max&&this.hide(l.first()))}var c,u;if(r.$targets){var p=this.getIndex(r.$elements,e);p=p>=r.$targets.length?r.$targets.length-1:p,c=r.$targets.eq(p),c.hasClass(r.class)||(u=!0,this.on(c))}"xt-overlay"===r.name&&(h.hasClass(r.class)||(this.on(h),this.onFixed(t("*:fixed").not(h).add("html")))),s||(o&&e.trigger("show.xt",[n,!0]),u&&c.trigger("show.xt",[n,!0]))},a.prototype.hide=function(e,s,i,a){var o,n=this,r=this.settings,h=(this.group,t(this.group));if(e&&e.hasClass(r.class)){var l=this.getCurrents();(i||"xt-ajax"===r.name||l.length>r.min)&&(o=!0,this.off(e),l=this.setCurrents(l.not(e.get(0)))),i||"xt-ajax"===r.name?this.checkDisabled(e,"enable"):this.checkDisabled(e),s||e.trigger("hide.xt",[n,!0])}var c,u;if(r.$targets){var p=this.getIndex(r.$elements,e);p=p>=r.$targets.length?r.$targets.length-1:p,c=r.$targets.eq(p),c.hasClass(r.class)&&(u=!0,this.off(c))}"xt-overlay"===r.name&&h.hasClass(r.class)&&(this.off(h),this.offFixed(t(".xt-fixed, html"))),s||(o&&e.trigger("hide.xt",[n,!0]),u&&c.trigger("hide.xt",[n,!0]))},a.prototype.on=function(e){var s=this.settings;this.group,t(this.group);if(e.addClass(s.class),e.hasClass("xt-height")){var i=e.find(".xt-height-inside");i.length||(e.wrapInner('<div class="xt-height-inside"></div>'),i=e.find(".xt-height-inside"));var a=i.outerHeight();e.css("height",a),e.parents(".xt-height-top").css("margin-top",-a),e.parents(".xt-height-bottom").css("margin-bottom",-a)}},a.prototype.off=function(e){var s=this.settings;this.group,t(this.group);e.removeClass(s.class),e.hasClass("xt-height")&&(e.css("height",0),e.parents(".xt-height-top").css("margin-top",0),e.parents(".xt-height-bottom").css("margin-bottom",0))},a.prototype.onFixed=function(s){var i=(this.settings,this.group,t(this.group),e.xtScrollbarWidth(s));i="hidden"===s.css("overflow-y")?0:i,s.addClass("xt-fixed").css("padding-right",i).css("background-clip","content-box")},a.prototype.offFixed=function(e){this.settings,this.group,t(this.group);e.removeClass("xt-fixed").css("padding-right",0).css("background-clip","")},a.prototype.getIndex=function(e,s){var i=0;return e&&s&&e.each(function(e){if(t(this).is(s.get(0)))return i=e,!1}),i},a.prototype.checkDisabled=function(e,s){var i=this.settings;this.group,t(this.group);if("click"===i.on)if(s)"disable"===s?e.attr("disabled",""):"enable"===s&&e.removeAttr("disabled");else{var a=this.getCurrents(),o=i.min;a.length===o?a.attr("disabled",""):a.removeAttr("disabled")}},a.prototype.ajax=function(e,s){var i=this,a=this.settings;this.group,t(this.group);a.$targets.attr("data-xt-ajaxified")!==e&&t.ajax({type:"GET",url:e,success:function(o,n,r){var h=t("<div />").html(o);a.$targets.trigger("ajax.success.xt",[i,h]);var l=h.find(a.targets).contents();s=s?s:h.find("title").text(),a.$targets.html(l),a.$targets.attr("data-xt-ajaxified",e),i.scoping(),i.events(),i.pushstate(e,s),a.$targets.trigger("ajax.populated.xt",[i,h])},error:function(t,s,i){console.error("ajax error url:"+e+" "+i)}})},a.prototype.pushstate=function(e,i){var a=this,o=this.settings;this.group,t(this.group);s.title=i,o.$elements.filter('[href="'+e+'"]').each(function(e){a.show(t(this),!0,!1,!0)}),history.state&&history.state.url&&history.state.url===e||history.pushState({url:e,title:i},i,e)},e.xtScrollbarWidth=function(e){var s,a,o;return o===i&&(s=t('<div style="width:50px; height:50px; overflow:auto;"><div /></div>').appendTo(e),a=s.children(),o=a.innerWidth()-a.height(99).innerWidth(),s.remove()),o},e.xtRequestAnimationFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)}}(),t.fn.xtPushElement=function(t){return Array.prototype.push.apply(this,t),this},t.event.special.xtRemoved={remove:function(t){t.handler&&t.handler()}},t.expr[":"].parents=function(e,s,i){return t(e).parents(i[3]).length<1},t.expr[":"].fixed=function(e,s,i){return"fixed"===t(e).css("position")},t.expr[":"].absolute=function(e,s,i){return"absolute"===t(e).css("position")}}(jQuery,window,document);