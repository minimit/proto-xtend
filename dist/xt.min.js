/*! xtend v0.0.6 (http://www.minimit.com/xtend/)
@copyright (c) 2016 - 2017 Riccardo Caroli
@license MIT (https://github.com/minimit/xtend/blob/master/LICENSE) */
!function(t,e,s,o){"use strict";var a=function(e,s,o){this.group=e,this.settings=t.extend({},o,s),this.init()},n=function(t,e,s){a.call(this,t,e,s)};n.prototype=Object.create(a.prototype),n.prototype.constructor=n,t.fn.xtToggle=function(e){var s={name:"xt-toggle",elements:null,targets:null,multiple:!1,class:"active",on:"click",off:null,min:0,max:1};return this.each(function(){t.data(this,s.name)||t.data(this,s.name,new n(this,e,s))})};var i=function(t,e,s){a.call(this,t,e,s)};i.prototype=Object.create(a.prototype),i.prototype.constructor=i,t.fn.xtOverlay=function(e){var s={name:"xt-overlay",targets:"",multiple:!0,on:"click",class:"overlay",min:0,max:1};return this.each(function(){t.data(this,s.name)||t.data(this,s.name,new i(this,e,s))})};var r=function(t,e,s){a.call(this,t,e,s)};r.prototype=Object.create(a.prototype),r.prototype.constructor=r,t.fn.xtScroll=function(e){var s={name:"xt-scroll",on:"scroll",class:"scroll",min:0,max:1};return this.each(function(){t.data(this,s.name)||t.data(this,s.name,new r(this,e,s))})};var l=function(t,e,s){a.call(this,t,e,s)};l.prototype=Object.create(a.prototype),l.prototype.constructor=l,t.fn.xtAjax=function(e){var s={name:"xt-ajax",targets:null,on:"click",class:"active",url:null};return this.each(function(){t.data(this,s.name)||t.data(this,s.name,new l(this,e,s))})},t.fn.xt={uid:0},t.fn.xtInitAll=function(e){return this.each(function(){t(this).is("[data-xt-toggle]")&&t(this).xtToggle(),t(this).is("[data-xt-overlay]")&&t(this).xtOverlay(),t(this).is("[data-xt-scroll]")&&t(this).xtScroll(),t(this).is("[data-xt-ajax]")&&t(this).xtAjax(),e&&(t(this).find("[data-xt-toggle]").xtToggle(),t(this).find("[data-xt-overlay]").xtOverlay(),t(this).find("[data-xt-scroll]").xtScroll(),t(this).find("[data-xt-ajax]").xtAjax())})},a.prototype.init=function(){var e=this,s=this.settings,o=(this.group,t(this.group));(o.attr("debug")||""===o.attr("debug"))&&(s.debug=!0),t.extend(s,o.data(s.name)),e.scoping(),e.namespace(),e.setup(),e.events()},a.prototype.namespace=function(){var e=this.settings,s=(this.group,t(this.group));e.targets&&e.targets.indexOf("#")!==-1?e.uid=e.targets:s.attr("id")?e.uid=s.attr("id"):e.uid="unique"+t.fn.xt.uid++,e.namespace=e.name+"_"+e.uid+"_"+e.class,s.attr("data-xt-namespace",e.namespace)},a.prototype.scoping=function(){var e=this.settings,s=(this.group,t(this.group));e.elements?e.elements.indexOf("#")!==-1?e.$elements=t(e.elements).filter(":parents(.xt-ignore)"):(e.$elements=s.find(e.elements).filter(":parents(.xt-ignore)"),e.$elements.length||(e.$elements=s.parent().find(e.elements).filter(":parents(.xt-ignore)"))):e.$elements=s,"xt-scroll"===e.name?(s.wrap(t('<div class="xt-container"></div>')),e.$targets=s.clone().addClass("xt-clone xt-ignore").css("visibility","hidden"),t.each(e.$targets.data(),function(t){e.$targets.removeAttr("data-"+t)}),e.$targets.insertAfter(s),"absolute"===e.mode?s.css("position","absolute"):"fixed"===e.mode&&s.css("position","fixed"),s.is(":fixed")||s.is(":absolute")?(s.css("z-index",70),e.$targets.css("display","block")):e.$targets.css("display","none")):e.targets&&(e.targets.indexOf("#")!==-1?e.$targets=t(e.targets).filter(":parents(.xt-ignore)"):(e.$targets=s.find(e.targets).filter(":parents(.xt-ignore)"),e.$targets.length||(e.$targets=s.parent().find(e.targets).filter(":parents(.xt-ignore)"))))},a.prototype.setup=function(){var o=this,a=this.settings;this.group,t(this.group);if("xt-ajax"===a.name){var n,i;if(history.state&&history.state.url)n=history.state.url;else{var r=e.location.href.split("#")[0];n=r.replace(/https?:\/\/[^\/]+/i,"")}a.$elements.each(function(){if(t(this).attr("href")===n)return i=t(this),!1}),i&&(a.$targets.attr("data-xt-ajaxified",n),o.pushstate(n,s.title),o.show(i),a.$targets.trigger("ajax.init.xt",[o]))}else if(a.$elements){a.$elements.each(function(){t(this).hasClass(a.class)&&(t(this).removeClass(a.class),o.show(t(this)))});var l=a.min,c=o.getCurrents();c.length<l&&o.show(a.$elements.eq(0))}},a.prototype.events=function(){var e=this,s=this.settings;this.group,t(this.group);"xt-scroll"===s.name?e.eventsScroll():e.eventsDefault()},a.prototype.eventsDefault=function(){var s=this,o=this.settings;this.group,t(this.group);o.$elements&&(o.on&&o.$elements.off(o.on).on(o.on,function(e){s.toggle(t(this)),"xt-ajax"===o.name&&e.preventDefault()}),o.off&&o.$elements.off(o.off).on(o.off,function(e){s.toggle(t(this))}),o.$elements.on("xtRemoved",function(e){"xt-overlay"===o.name&&(s.hide(t(this),!1,!0,!0),console.log("ccc"))}),o.$elements.on("on.xt",function(e,o,a){a||e.target!==this||s.show(t(this),!0)}),o.$elements.on("off.xt",function(e,o,a){a||e.target!==this||s.hide(t(this),!0)})),"xt-ajax"===o.name&&(t(e).off("popstate.xt."+o.namespace),t(e).on("popstate.xt."+o.namespace,function(t){history.state&&history.state.url&&s.ajax(history.state.url,history.state.title)}))},a.prototype.eventsScroll=function(){var s=this,o=this.settings,a=(this.group,t(this.group)),n="scroll.xt."+o.namespace;t(e).off(n),t(e).on(n,function(n){var i=t(this).scrollTop(),r=o.$targets.parents(".xt-container").offset().top,l=1/0;o.top&&(r=isNaN(parseFloat(o.top))?t(o.top).offset().top:o.top),o.bottom&&(isNaN(parseFloat(o.bottom))?t(o.bottom).length&&(l=t(o.bottom).offset().top):l=o.bottom),i>r&&i<l?a.hasClass(o.class)||(e.xtRequestAnimationFrame(function(){s.show(a)}),a.removeClass("scroll-off-top scroll-off-bottom"),o.scrollTopOld>i?(a.removeClass("scroll-on-top"),e.xtRequestAnimationFrame(function(){a.addClass("scroll-on-bottom")})):(a.removeClass("scroll-on-bottom"),e.xtRequestAnimationFrame(function(){a.addClass("scroll-on-top")}))):a.hasClass(o.class)&&(e.xtRequestAnimationFrame(function(){s.hide(a)}),a.removeClass("scroll-on-top scroll-on-bottom"),o.scrollTopOld>i?(a.removeClass("scroll-off-top"),e.xtRequestAnimationFrame(function(){a.addClass("scroll-off-bottom")})):(a.removeClass("scroll-off-bottom"),e.xtRequestAnimationFrame(function(){a.addClass("scroll-off-top")}))),o.scrollTopOld=i}),t(e).trigger(n),a.on("xtRemoved",function(s){t(e).off(n)})},a.prototype.toggle=function(e,s,o,a){var n=this,i=this.settings;this.group,t(this.group);e.hasClass(i.class)?n.hide(e,s,o,a):n.show(e,s,o,a)},a.prototype.show=function(e,s,o,a){var n=this,i=this.settings,r=(this.group,t(this.group));if(e&&!e.hasClass(i.class)){n.on(n.getElements(i.$elements,e),s);var l=n.getCurrents();if(l=n.setCurrents(l.pushElement(e)),!o){var c=t('[data-xt-namespace="'+i.namespace+'"]').filter(":parents(.xt-ignore)").not(r);c.each(function(){var e=t(this).data(i.name);e.show(t(this),!0,!0)})}if("xt-ajax"===i.name)n.checkDisabled(e,"disable"),n.ajax(e.attr("href"));else if(n.checkDisabled(e),!o&&l.length>i.max){var h=l.first();h.attr("data-group");n.hide(h)}}if(i.$targets){var u=n.getTargets(i.$elements,e,i.$targets);u.hasClass(i.class)||(n.on(u,s),"xt-overlay"===i.name&&(t("html").addClass(i.class),n.onFixed(t("*:fixed").not(u).add("html")),r.hasClass(i.class)||n.on(r,s)))}},a.prototype.hide=function(e,s,o,a){var n=this,i=this.settings,r=(this.group,t(this.group));if(e){var l=n.getCurrents();if(e.hasClass(i.class)){if((o||"xt-ajax"===i.name||l.length>i.min)&&(n.off(n.getElements(i.$elements,e),s),l=e.attr("data-group")?n.setCurrents(l.not("[data-group="+e.attr("data-group")+"]")):n.setCurrents(l.not(e.get(0))),!o)){var c=t('[data-xt-namespace="'+i.namespace+'"]').filter(":parents(.xt-ignore)").not(r);c.each(function(){var e=t(this).data(i.name);e.hide(t(this),!0,!0)})}o||"xt-ajax"===i.name?n.checkDisabled(e,"enable"):n.checkDisabled(e)}}if(i.$targets){var h=n.getTargets(i.$elements,e,i.$targets);h.hasClass(i.class)&&(n.off(h,s),"xt-overlay"===i.name&&(t("html").removeClass(i.class),n.offFixed(t(".xt-fixed, html")),r.hasClass(i.class)&&n.off(r,s)))}},a.prototype.on=function(s,o){var a=this,n=this.settings;this.group,t(this.group);s.addClass(n.class),s.removeClass("fadeout"),clearTimeout(s.data("fade.timeout")),s.off("transitionend.xt"),e.xtRequestAnimationFrame(function(){if(s.addClass("fadein"),n.fadeout){var t=e.setTimeout(function(t,e){t.onDone(e,o)},n.fadeout,a,s);s.data("fade.timeout",t)}else"0s"!==s.css("transitionDuration")?s.one("transitionend.xt",function(t){a.onDone(s)}):a.onDone(s,o)}),a.onHeight(s,o),o||s.trigger("on.xt",[a,!0])},a.prototype.onDone=function(e,s){var o=this;this.settings,this.group,t(this.group);o.autoHeight(e),s||e.trigger("fadein.xt",[o,!0])},a.prototype.off=function(s,o){var a=this,n=this.settings;this.group,t(this.group);s.removeClass("fadein"),clearTimeout(s.data("fade.timeout")),s.off("transitionend.xt"),e.xtRequestAnimationFrame(function(){if(s.addClass("fadeout"),n.fadeout){var t=e.setTimeout(function(t,e){t.offDone(e)},n.fadeout,a,s);s.data("fade.timeout",t)}else"0s"!==s.css("transitionDuration")?s.one("transitionend.xt",function(t){a.offDone(s)}):a.offDone(s,o)}),a.onHeight(s,o),e.xtRequestAnimationFrame(function(){a.offHeight(s,o)}),o||s.trigger("off.xt",[a,!0])},a.prototype.offDone=function(e,s){var o=this,a=this.settings;this.group,t(this.group);e.removeClass(a.class),e.removeClass("fadeout"),s||e.trigger("fadeout.xt",[o,!0])},a.prototype.onHeight=function(t){if(t.hasClass("collapse-height")){var e=t.find(".collapse-height-inside");e.length||(t.wrapInner('<div class="collapse-height-inside"></div>'),e=t.find(".collapse-height-inside"));var s=e.outerHeight();t.css("height",s),t.parents(".collapse-top").css("margin-top",-s),t.parents(".collapse-bottom").css("margin-bottom",-s)}},a.prototype.offHeight=function(t){t.hasClass("collapse-height")&&(t.css("height",0),t.parents(".collapse-top").css("margin-top",0),t.parents(".collapse-bottom").css("margin-bottom",0))},a.prototype.autoHeight=function(t){t.hasClass("collapse-height")&&t.css("height","auto")},a.prototype.getCurrents=function(){var e=this.settings,s=(this.group,t(this.group)),o=s.data("$currents_"+e.namespace)||t([]);return o},a.prototype.setCurrents=function(e){var s=this.settings,o=(this.group,t(this.group));return o.data("$currents_"+s.namespace,e),e},a.prototype.getElements=function(t,e){if(e.is("[data-group]")){var s=e.attr("data-group");return t.filter('[data-group="'+s+'"]')}return e},a.prototype.getTargets=function(t,e,s){if(e.is("[data-group]")){var o=e.attr("data-group");return s.filter('[data-group="'+o+'"]')}var a=this.getIndex(t.not("[data-group]"),e);return s.not("[data-group]").eq(a)},a.prototype.onFixed=function(e){var s=this,o=(this.settings,this.group,t(this.group),s.scrollbarWidth(e));o="hidden"===e.css("overflow-y")?0:o,e.addClass("xt-fixed").css("padding-right",o).css("background-clip","content-box")},a.prototype.offFixed=function(e){this.settings,this.group,t(this.group);e.removeClass("xt-fixed").css("padding-right",0).css("background-clip","")},a.prototype.getIndex=function(e,s){var o=0;return e&&s&&e.each(function(e){if(t(this).is(s.get(0)))return o=e,!1}),o},a.prototype.checkDisabled=function(e,s){var o=this,a=this.settings;this.group,t(this.group);if("click"===a.on)if(s)"disable"===s?e.attr("disabled",""):"enable"===s&&e.removeAttr("disabled");else{var n=o.getCurrents(),i=a.min;n.length===i?n.attr("disabled",""):n.removeAttr("disabled")}},a.prototype.scrollbarWidth=function(e){var s,a,n;return n===o&&(s=t('<div style="width:50px; height:50px; overflow:auto;"><div /></div>').appendTo(e),a=s.children(),n=a.innerWidth()-a.height(99).innerWidth(),s.remove()),n},a.prototype.ajax=function(e,s){var o=this,a=this.settings;this.group,t(this.group);a.$targets.attr("data-xt-ajaxified")!==e&&t.ajax({type:"GET",url:e,success:function(n,i,r){var l=t("<div />").html(n);a.$targets.trigger("ajax.success.xt",[o,l]);var c=l.find(a.targets).contents();s=s?s:l.find("title").text(),a.$targets.html(c),a.$targets.attr("data-xt-ajaxified",e),o.scoping(),o.events(),o.pushstate(e,s),a.$targets.trigger("ajax.populated.xt",[o,l])},error:function(t,s,o){console.error("ajax error url:"+e+" "+o)}})},a.prototype.pushstate=function(e,o){var a=this,n=this.settings;this.group,t(this.group);s.title=o,n.$elements.filter('[href="'+e+'"]').each(function(e){a.show(t(this),!0,!1,!0)}),history.state&&history.state.url&&history.state.url===e||history.pushState({url:e,title:o},o,e)},e.xtRequestAnimationFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)}}(),t.fn.pushElement=function(t){return Array.prototype.push.apply(this,t),this},t.event.special.xtRemoved={remove:function(t){t.handler&&t.handler()}},t.expr[":"].parents=function(e,s,o){return t(e).parents(o[3]).length<1},t.expr[":"].fixed=function(e,s,o){return"fixed"===t(e).css("position")},t.expr[":"].absolute=function(e,s,o){return"absolute"===t(e).css("position")}}(jQuery,window,document);