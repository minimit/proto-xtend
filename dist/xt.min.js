/*! xtend v0.0.5 (http://)
@copyright (c) 2016 - 2017 Riccardo Caroli
@license MIT (https://github.com/minimit/xtend/blob/master/LICENSE) */
!function(t,e,a,s){"use strict";function i(e,a){this.element=e,this.settings=t.extend({},r,a),this._defaults=r,this._name=n,this.init()}var n="xt",r={type:null,on:"click",target:"",class:"active",group:"",grouping:"xt",min:1,max:1,ajax:null,url:null,groupIndex:null};t.extend(i.prototype,{init:function(){var a=this,s=this.settings,i=(this.element,t(this.element));(i.attr("debug")||""===i.attr("debug"))&&(s.debug=!0);var n=i.data("xt");n?(n.type&&("ajax"===n.type?(t.extend(s,{ajax:{url:"href"}}),t.extend(s,i.data("xt-ajax"))):"toggle"===n.type?(t.extend(s,{min:0,max:1}),t.extend(s,i.data("xt-toggle"))):"scroll"===n.type&&(t.extend(s,{min:0,max:1}),t.extend(s,i.data("xt-scroll")))),t.extend(s,n)):i.attr("data-xt",""),a.scoping(),a.events(),e.requestAnimFrame(function(){a.setup()})},scoping:function(){var e=this.settings,a=(this.element,t(this.element));e.target&&e.group?(e.$group=a.parents(e.group),e.$target=e.$group.find(e.target)):e.target?(e.$target=t(e.target),e.$group=e.$target.parent()):e.$group=a.parent(),e.namespace=e.grouping+"_"+e.group,a.attr("data-xt-button",e.namespace)},setup:function(){var s=this,i=this.settings,n=(this.element,t(this.element));i.ajax&&"href"===i.ajax.url&&(i.ajax.url=n.attr("href"));var r=this.getButtons();if(r.each(function(e){t(this).is(n)&&(i.groupIndex=e)}),i.target&&i.$target.length>1&&(i.$target=i.$target.eq(i.groupIndex)),n.hasClass(i.class)&&this.show(),i.ajax){n.attr("data-xt-pushstate","true");var l;if(history.state&&history.state.url)i.ajax.url===history.state.url&&(l=!0);else{var o=e.location.href.split("#")[0];o=o.replace(/https?:\/\/[^\/]+/i,""),o===i.ajax.url&&(l=!0)}l&&(i.ajax.title=i.ajax.title?i.ajax.title:a.title,i.$target.attr("data-xt-ajaxified",i.ajax.url),this.pushstate(),this.show(),i.$target.trigger("ajax.init.xt",[s]))}else{var h=i.min,u=r.filter("."+i.class);u.length<h&&this.show()}},events:function(){var a=this,s=this.settings,i=(this.element,t(this.element));if("scroll"===s.type){s.$clone||(i.wrap(t('<div class="box xt-container"></div>')),s.$clone=i.clone().addClass("box xt-ignore").css("visibility","hidden").css("display","none"),t.each(s.$clone.data(),function(t){s.$clone.removeAttr("data-"+t)}),s.$clone.insertAfter(i));var n="scroll.xt."+s.namespace;t(e).off(n),t(e).on(n,function(){var e=t(this),n=e.scrollTop(),r=i.parents(".xt-container").offset().top,l=1/0;s.scrollTop&&(r=t(s.scrollTop).offset().top),s.scrollBottom&&(l=t(s.scrollBottom).offset().top),n>r&&n<l?(a.show(),s.$clone.css("display","block")):(a.hide(),s.$clone.css("display","none"))}),clearTimeout(e[n]),e[n]=e.setTimeout(function(){t(e).trigger(n)},0)}else i.on(s.on,function(t){a.toggle(),s.ajax&&t.preventDefault()})},getButtons:function(){var e=this.settings,a=(this.element,t(this.element),e.$group.find('[data-xt-button="'+e.namespace+'"]').filter(":parents(.xt-ignore)"));return a},getCurrents:function(){var e=this.settings,a=(this.element,t(this.element),e.$group.data("$currents_"+e.namespace)||t([]));return a},setCurrents:function(e){var a=this.settings;this.element,t(this.element);return a.$group.data("$currents_"+a.namespace,e),e},toggle:function(e,a,s){var i=this,n=this.settings,r=(this.element,t(this.element)),l=this.getButtons();r.hasClass(n.class)?n.ajax||(this.hide(e,a,s),l.each(function(a){var i=t(this).data("plugin_xt");i.settings.$target.is(n.$target)&&i.hide(e,!0,s)})):(this.show(e,a,s),n.ajax||l.each(function(a){var i=t(this).data("plugin_xt");i.settings.$target.is(n.$target)&&i.show(e,!0,s)})),e||(r.trigger("toggle.xt",[i]),n.target&&n.$target.trigger("toggle.xt",[i]))},show:function(e,a,s){var i=this,n=this.settings,r=(this.element,t(this.element));if(!r.hasClass(n.class)){var l,o=this.getCurrents();if(r.addClass(n.class),o=this.setCurrents(o.pushElement(r)),n.target&&!n.$target.hasClass(n.class)&&(l=!0,n.$target.addClass(n.class)),n.ajax)this.checkDisabled("disable"),i.ajax(e,a,s);else if(this.checkDisabled(),!a&&o.length>n.max){var h=o.first().data("plugin_xt");h&&h.hide()}e||(r.trigger("show.xt",[i]),l&&n.$target.trigger("show.xt",[i]))}},hide:function(e,a,s){var i=this,n=this.settings,r=this.element,l=t(this.element);if(l.hasClass(n.class)){var o,h=this.getCurrents();(a||n.ajax||h.length>n.min)&&(l.removeClass(n.class),h=this.setCurrents(h.not(r)),n.target&&n.$target.hasClass(n.class)&&(o=!0,n.$target.removeClass(n.class))),a||n.ajax?this.checkDisabled("enable"):this.checkDisabled(),e||(l.trigger("hide.xt",[i]),o&&n.$target.trigger("hide.xt",[i]))}},checkDisabled:function(e){var a=this.settings,s=(this.element,t(this.element)),i=this.getCurrents();if(e)"disable"===e?s.attr("disabled",""):"enable"===e&&s.removeAttr("disabled");else{var n=a.min;i.length===n?i.attr("disabled",""):i.removeAttr("disabled")}},ajax:function(e,s,i){var n=this,r=this.settings;this.element,t(this.element);r.$target.attr("data-xt-ajaxified")!==r.ajax.url&&t.ajax({type:"GET",url:r.ajax.url,success:function(e,s,l){t(a).find("[data-xt-resetonajax]").filter(":parents(.xt-ignore)").each(function(e){var a=t(this).data("plugin_xt");a.hide(!0,!1,!0)});var o=t("<div />").html(e),h=o.find(r.target).contents();r.$target.html(h),r.$target.attr("data-xt-ajaxified",r.ajax.url),i||(r.ajax.title=r.ajax.title?r.ajax.title:o.find("title").text(),n.pushstate(!0)),r.$target.trigger("ajax.done.xt",[n,o])},error:function(t,e,a){console.error("ajax error url:"+r.ajax.url+" "+a)}})},pushstate:function(e){var s=this.settings,i=(this.element,t(this.element),s.ajax.title);if(!history.state||!history.state.url||history.state.url!==s.ajax.url){var n=s.ajax.url;history.pushState({url:n,title:i},i,n),t(a).find("[data-xt-pushstate]").filter(":parents(.xt-ignore)").each(function(a){var s=t(this).data("plugin_xt");s.pushstateListener(n,e)})}a.title=i},pushstateListener:function(e,a){var s=this,i=this.settings;this.element,t(this.element);i.ajax.url===e?s.show(a,!1,!0):s.hide(a,!1,!0)}}),t.fn[n]=function(e){return this.each(function(){t.data(this,"plugin_"+n)||t.data(this,"plugin_"+n,new i(this,e))})},e.onpopstate=function(e){e.state&&e.state.url&&(a.title=e.state.title,t(a).find("[data-xt-pushstate]").filter(":parents(.xt-ignore)").each(function(a,s){var i=t(this).data("plugin_xt");i.pushstateListener(e.state.url)}))},e.requestAnimFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)}}(),t.fn.pushElement=function(t){return Array.prototype.push.apply(this,t),this},t.expr[":"].parents=function(e,a,s){return t(e).parents(s[3]).length<1},t(a).ready(function(){t.fn[n].manualInit||t("[data-"+[n]+"]")[n]()})}(jQuery,window,document);