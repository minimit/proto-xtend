/*! xtend v0.0.6 (http://www.minimit.com/xtend/)
@copyright (c) 2016 - 2017 Riccardo Caroli
@license MIT (https://github.com/minimit/xtend/blob/master/LICENSE) */
!function(t,e,s,a){"use strict";var o=function(e,s,a){this.group=e,this.settings=t.extend({},a,s),this.init()},i=function(t,e,s){o.call(this,t,e,s)};i.prototype=Object.create(o.prototype),i.prototype.constructor=i,t.fn.xtToggle=function(e){var s={name:"xt-toggle",elements:null,targets:null,multiple:!1,class:"active",on:"click",off:null,min:0,max:1};return this.each(function(){t.data(this,s.name)||t.data(this,s.name,new i(this,e,s))})};var n=function(t,e,s){o.call(this,t,e,s)};n.prototype=Object.create(o.prototype),n.prototype.constructor=n,t.fn.xtOverlay=function(e){var s={name:"xt-overlay",targets:"",multiple:!0,on:"click",class:"overlay",min:0,max:1};return this.each(function(){t.data(this,s.name)||t.data(this,s.name,new n(this,e,s))})};var r=function(t,e,s){o.call(this,t,e,s)};r.prototype=Object.create(o.prototype),r.prototype.constructor=r,t.fn.xtScroll=function(e){var s={name:"xt-scroll",on:"scroll",class:"scroll",min:0,max:1};return this.each(function(){t.data(this,s.name)||t.data(this,s.name,new r(this,e,s))})};var l=function(t,e,s){o.call(this,t,e,s)};l.prototype=Object.create(o.prototype),l.prototype.constructor=l,t.fn.xtAjax=function(e){var s={name:"xt-ajax",targets:null,on:"click",class:"active",url:null};return this.each(function(){t.data(this,s.name)||t.data(this,s.name,new l(this,e,s))})},t.fn.xtInitAll=function(e){return this.each(function(){t(this).is("[data-xt-toggle]")&&t(this).xtToggle(),t(this).is("[data-xt-overlay]")&&t(this).xtOverlay(),t(this).is("[data-xt-scroll]")&&t(this).xtScroll(),t(this).is("[data-xt-ajax]")&&t(this).xtAjax(),e&&(t(this).find("[data-xt-toggle]").xtToggle(),t(this).find("[data-xt-overlay]").xtOverlay(),t(this).find("[data-xt-scroll]").xtScroll(),t(this).find("[data-xt-ajax]").xtAjax())})},o.prototype.init=function(){var e=this,s=this.settings,a=(this.group,t(this.group));(a.attr("debug")||""===a.attr("debug"))&&(s.debug=!0),t.extend(s,a.data(s.name)),e.scoping(),e.setup(),e.events()},o.prototype.scoping=function(){var s=this.settings,a=(this.group,t(this.group));s.elements?s.elements.indexOf("#")!==-1?s.$elements=t(s.elements).filter(":parents(.xt-ignore)"):(s.$elements=a.find(s.elements).filter(":parents(.xt-ignore)"),s.$elements.length||(s.$elements=a.parent().find(s.elements).filter(":parents(.xt-ignore)"))):s.$elements=a,"xt-scroll"===s.name?(a.wrap(t('<div class="xt-container"></div>')),s.$targets=a.clone().addClass("xt-clone xt-ignore").css("visibility","hidden"),t.each(s.$targets.data(),function(t){s.$targets.removeAttr("data-"+t)}),s.$targets.insertAfter(a),"absolute"===s.mode?a.css("position","absolute"):"fixed"===s.mode&&a.css("position","fixed"),a.is(":fixed")||a.is(":absolute")?(a.css("z-index",70),s.$targets.css("display","block")):s.$targets.css("display","none")):s.targets&&(s.targets.indexOf("#")!==-1?s.$targets=t(s.targets).filter(":parents(.xt-ignore)"):(s.$targets=a.find(s.targets).filter(":parents(.xt-ignore)"),s.$targets.length||(s.$targets=a.parent().find(s.targets).filter(":parents(.xt-ignore)"))),"xt-overlay"===s.name&&(s.$targets=s.$targets.xtPushElement(t("html")),console.log(s.$targets))),e.xtUniqueId=e.xtUniqueId?e.xtUniqueId:0;var o=a.attr("id")?a.attr("id"):"xtUniqueId"+e.xtUniqueId++;a.attr("id",o),s.namespace=s.name+"_"+o+"_"+s.class,a.attr("data-xt-group-"+s.name,s.namespace)},o.prototype.setup=function(){var a=this,o=this.settings;this.group,t(this.group);if("xt-ajax"===o.name){var i,n;if(history.state&&history.state.url)i=history.state.url;else{var r=e.location.href.split("#")[0];i=r.replace(/https?:\/\/[^\/]+/i,"")}o.$elements.each(function(){if(t(this).attr("href")===i)return n=t(this),!1}),n&&(o.$targets.attr("data-xt-ajaxified",i),a.pushstate(i,s.title),a.show(n),o.$targets.trigger("ajax.init.xt",[a]))}else if(o.$elements){o.$elements.each(function(){t(this).hasClass(o.class)&&(t(this).removeClass(o.class),a.show(t(this)))});var l=o.min,c=a.getCurrents();c.length<l&&a.show(o.$elements.eq(0))}},o.prototype.events=function(){var e=this,s=this.settings;this.group,t(this.group);"xt-scroll"===s.name?e.eventsScroll():e.eventsDefault()},o.prototype.eventsDefault=function(){var s=this,a=this.settings;this.group,t(this.group);a.$elements&&(a.on&&a.$elements.off(a.on).on(a.on,function(e){s.toggle(t(this)),"xt-ajax"===a.name&&e.preventDefault()}),a.off&&a.$elements.off(a.off).on(a.off,function(e){s.toggle(t(this))}),a.$elements.on("xtRemoved",function(e){(t(this).is("[data-xt-reset]")||"html"===a.targets)&&s.hide(t(this),!1,!0,!0)}),a.$elements.on("on.xt",function(e,a,o){o||e.target!==this||s.show(t(this),!0)}),a.$elements.on("off.xt",function(e,a,o){o||e.target!==this||s.hide(t(this),!0)})),"xt-ajax"===a.name&&(t(e).off("popstate.xt."+a.namespace),t(e).on("popstate.xt."+a.namespace,function(t){history.state&&history.state.url&&s.ajax(history.state.url,history.state.title)}))},o.prototype.eventsScroll=function(){var s=this,a=this.settings,o=(this.group,t(this.group)),i="scroll.xt."+a.namespace;t(e).off(i),t(e).on(i,function(i){var n=t(this).scrollTop(),r=a.$targets.parents(".xt-container").offset().top,l=1/0;a.top&&(r=isNaN(parseFloat(a.top))?t(a.top).offset().top:a.top),a.bottom&&(isNaN(parseFloat(a.bottom))?t(a.bottom).length&&(l=t(a.bottom).offset().top):l=a.bottom),n>r&&n<l?o.hasClass(a.class)||(e.xtRequestAnimationFrame(function(){s.show(o)}),o.removeClass("scroll-off-top scroll-off-bottom"),a.scrollTopOld>n?(o.removeClass("scroll-on-top"),e.xtRequestAnimationFrame(function(){o.addClass("scroll-on-bottom")})):(o.removeClass("scroll-on-bottom"),e.xtRequestAnimationFrame(function(){o.addClass("scroll-on-top")}))):o.hasClass(a.class)&&(e.xtRequestAnimationFrame(function(){s.hide(o)}),o.removeClass("scroll-on-top scroll-on-bottom"),a.scrollTopOld>n?(o.removeClass("scroll-off-top"),e.xtRequestAnimationFrame(function(){o.addClass("scroll-off-bottom")})):(o.removeClass("scroll-off-bottom"),e.xtRequestAnimationFrame(function(){o.addClass("scroll-off-top")}))),a.scrollTopOld=n}),t(e).trigger(i),o.on("xtRemoved",function(s){t(e).off(i)})},o.prototype.getCurrents=function(){var e=this.settings,s=(this.group,t(this.group)),a=s.data("$currents_"+e.namespace)||t([]);return a},o.prototype.setCurrents=function(e){var s=this.settings,a=(this.group,t(this.group));return a.data("$currents_"+s.namespace,e),e},o.prototype.toggle=function(e,s,a,o){var i=this,n=this.settings;this.group,t(this.group);e.hasClass(n.class)?i.hide(e,s,a,o):i.show(e,s,a,o)},o.prototype.show=function(e,s,a,o){var i=this,n=this.settings,r=(this.group,t(this.group));if(e&&!e.hasClass(n.class)){i.on(e,s);var l=i.getCurrents();l=i.setCurrents(l.xtPushElement(e)),"xt-ajax"===n.name?(i.checkDisabled(e,"disable"),i.ajax(e.attr("href"))):(i.checkDisabled(e),a||l.length>n.max&&i.hide(l.first()))}var c;if(n.$targets){var h=i.getIndex(n.$elements,e);h=h>=n.$targets.length?n.$targets.length-1:h,c=n.$targets.eq(h),c.hasClass(n.class)||i.on(c,s)}"xt-overlay"===n.name&&(r.hasClass(n.class)||(i.on(r,s),i.onFixed(t("*:fixed").not(r).add("html"))))},o.prototype.hide=function(e,s,a,o){var i=this,n=this.settings,r=(this.group,t(this.group));if(e&&e.hasClass(n.class)){var l=i.getCurrents();(a||"xt-ajax"===n.name||l.length>n.min)&&(i.off(e,s),l=i.setCurrents(l.not(e.get(0)))),a||"xt-ajax"===n.name?i.checkDisabled(e,"enable"):i.checkDisabled(e)}var c;if(n.$targets){var h=i.getIndex(n.$elements,e);h=h>=n.$targets.length?n.$targets.length-1:h,c=n.$targets.eq(h),c.hasClass(n.class)&&i.off(c,s)}"xt-overlay"===n.name&&r.hasClass(n.class)&&(i.off(r,s),i.offFixed(t(".xt-fixed, html")))},o.prototype.on=function(s,a){var o=this,i=this.settings;this.group,t(this.group);if(s.addClass(i.class),s.removeClass("fadeout"),clearTimeout(s.data("fadeout.timeout")),s.off("transitionend.xt"),(i.fadein||"0s"!==s.css("transitionDuration")||"0s"!==s.css("animationDuration"))&&e.xtRequestAnimationFrame(function(){s.addClass("fadein")}),s.hasClass("collapse-height")){var n=s.find(".collapse-height-inside");n.length||(s.wrapInner('<div class="collapse-height-inside"></div>'),n=s.find(".collapse-height-inside"));var r=n.outerHeight();s.css("height",r),s.parents(".collapse-top").css("margin-top",-r),s.parents(".collapse-bottom").css("margin-bottom",-r)}a||s.trigger("on.xt",[o,!0])},o.prototype.off=function(s,a){var o=this,i=this.settings;this.group,t(this.group);s.removeClass("fadein"),s.addClass("fadeout");var n=function(){s.removeClass(i.class),s.removeClass("fadeout")};if(i.fadeout){clearTimeout(s.data("fadeout.timeout"));var r=e.setTimeout(function(){n()},i.fadeout);s.data("fadeout.timeout",r)}else"0s"!==s.css("transitionDuration")||"0s"!==s.css("animationDuration")?s.off("transitionend.xt").on("transitionend.xt",function(t){n()}):n();s.hasClass("collapse-height")&&(s.css("height",0),s.parents(".collapse-top").css("margin-top",0),s.parents(".collapse-bottom").css("margin-bottom",0)),a||s.trigger("off.xt",[o,!0])},o.prototype.onFixed=function(s){var a=(this.settings,this.group,t(this.group),e.xtScrollbarWidth(s));a="hidden"===s.css("overflow-y")?0:a,s.addClass("xt-fixed").css("padding-right",a).css("background-clip","content-box")},o.prototype.offFixed=function(e){this.settings,this.group,t(this.group);e.removeClass("xt-fixed").css("padding-right",0).css("background-clip","")},o.prototype.getIndex=function(e,s){var a=0;return e&&s&&e.each(function(e){if(t(this).is(s.get(0)))return a=e,!1}),a},o.prototype.checkDisabled=function(e,s){var a=this,o=this.settings;this.group,t(this.group);if("click"===o.on)if(s)"disable"===s?e.attr("disabled",""):"enable"===s&&e.removeAttr("disabled");else{var i=a.getCurrents(),n=o.min;i.length===n?i.attr("disabled",""):i.removeAttr("disabled")}},o.prototype.ajax=function(e,s){var a=this,o=this.settings;this.group,t(this.group);o.$targets.attr("data-xt-ajaxified")!==e&&t.ajax({type:"GET",url:e,success:function(i,n,r){var l=t("<div />").html(i);o.$targets.trigger("ajax.success.xt",[a,l]);var c=l.find(o.targets).contents();s=s?s:l.find("title").text(),o.$targets.html(c),o.$targets.attr("data-xt-ajaxified",e),a.scoping(),a.events(),a.pushstate(e,s),o.$targets.trigger("ajax.populated.xt",[a,l])},error:function(t,s,a){console.error("ajax error url:"+e+" "+a)}})},o.prototype.pushstate=function(e,a){var o=this,i=this.settings;this.group,t(this.group);s.title=a,i.$elements.filter('[href="'+e+'"]').each(function(e){o.show(t(this),!0,!1,!0)}),history.state&&history.state.url&&history.state.url===e||history.pushState({url:e,title:a},a,e)},e.xtScrollbarWidth=function(e){var s,o,i;return i===a&&(s=t('<div style="width:50px; height:50px; overflow:auto;"><div /></div>').appendTo(e),o=s.children(),i=o.innerWidth()-o.height(99).innerWidth(),s.remove()),i},e.xtRequestAnimationFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)}}(),t.fn.xtPushElement=function(t){return Array.prototype.push.apply(this,t),this},t.event.special.xtRemoved={remove:function(t){t.handler&&t.handler()}},t.expr[":"].parents=function(e,s,a){return t(e).parents(a[3]).length<1},t.expr[":"].fixed=function(e,s,a){return"fixed"===t(e).css("position")},t.expr[":"].absolute=function(e,s,a){return"absolute"===t(e).css("position")}}(jQuery,window,document);